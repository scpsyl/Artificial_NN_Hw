## 动态神经网络

使用MATLAB中的动态网络工具包，建立非线性自回归神经网络，并分别从网络规模、网络结构、不同输入数据方面比较训练结果的差异。本实验以 NARX 网络为基础，分别从不同网络结构、不同网络规模下，分别对工具包中的**简单采集时序信号**和**管道阀流速**数据集进行实验，并比较结果差异

> 具体实现代码见Task3文件夹下
>
> * Task3_1对应不同网络规模
> * Task3_2对应不同网络结构

#### 不同网络规模

简单采集时序信号作为输入，固定输入延迟和反馈延迟为 `1:2`，通过调整隐藏层节点数研究网络规模对模型性能的影响。设定的不同规模如下： 
* 小规模网络：5 个隐藏层节点。
* 中等规模网络：10 和 20 个隐藏层节点。
* 大规模网络：50 个隐藏层节点

**MSE**作为指标讨论，结果如下：

| HiddenNodes |    MSE     |
| :---------: | :--------: |
|      5      | 7.1052e-10 |
|     10      | 1.4579e-10 |
|     20      | 1.8987e-07 |
|     50      | 0.0023612  |

![Input:simplenarx_dataset](D:\Desktop\Artificial_NN_Hw\Homework4\Task3\image\output1.png)

管道阀流速的MSE和曲线如下：

| HiddenNodes |    MSE     |
| :---------: | :--------: |
|      5      | 93.859 |
|     10      | 83.944 |
|     20      | 88.92 |
|     50      | 85.078  |

![Inputs:Valve_dataset](Task3\image\output1.png)

可以看到 简单网络对于较复杂的信号的拟合效果较差，且对于过于简单的信号，过大的隐层节点数也会有过拟合的情况造成MSE偏大。

#### 不同网络结构

这里主要设定延迟窗口大小为变化指标，分别设置**输入延迟和反馈延迟**：`1:1`（短窗口）、`1:3`（中窗口）、`1:5`（长窗口）。结果如下：

|Delays |    MSE     |
| :---------: | :--------: |
|      1      | 0.014297 |
|     3      | 1.6456e-10 |
|     5      | 1.8712e-08 |

![](Task3\image\output3.png)

管道阀流速的MSE和曲线如下:

|Delays |    MSE     |
| :---------: | :--------: |
|      1      | 134.25 |
|     3      | 107.61 |
|     5      | 95.14 |

![](Task3\image\output4.png)

可以看到 对于较简单的信号，过大的延迟窗口会造成过拟合，使得实际性能偏差。

